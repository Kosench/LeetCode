185. Топ-три зарплаты по отделу
Сложность: Сложно
Темы:
Иконка премиум-доступа Компании
Схема SQL
Схема Pandas

Таблица: Employee (Сотрудник)

+--------------+---------+
| Имя столбца  | Тип     |
+--------------+---------+
| id           | int     |
| name         | varchar |
| salary       | int     |
| departmentId | int     |
+--------------+---------+
id — первичный ключ (столбец с уникальными значениями) для этой таблицы.
departmentId — внешний ключ (ссылающийся столбец), указывающий на ID из таблицы Department.
Каждая строка этой таблицы содержит информацию об ID, имени, зарплате сотрудника, а также об ID его отдела.

Таблица: Department (Отдел)

+-------------+---------+
| Имя столбца | Тип     |
+-------------+---------+
| id          | int     |
| name        | varchar |
+-------------+---------+
id — первичный ключ (столбец с уникальными значениями) для этой таблицы.
Каждая строка таблицы содержит ID отдела и его название.

Компания хочет выяснить, кто из сотрудников получает самые высокие зарплаты в каждом отделе. Высокооплачиваемым сотрудником отдела считается тот, чья зарплата входит в топ-3 уникальных значений зарплат в этом отделе.

Напишите запрос, чтобы найти сотрудников, которые являются высокооплачиваемыми в каждом из отделов.

Верните таблицу с результатами в любом порядке.

Формат результата приведён в примере ниже.

Пример 1:

Входные данные:
Таблица Employee (Сотрудник):

+----+-------+--------+--------------+
| id | name  | salary | departmentId |
+----+-------+--------+--------------+
| 1  | Joe   | 85000  | 1            |
| 2  | Henry | 80000  | 2            |
| 3  | Sam   | 60000  | 2            |
| 4  | Max   | 90000  | 1            |
| 5  | Janet | 69000  | 1            |
| 6  | Randy | 85000  | 1            |
| 7  | Will  | 70000  | 1            |
+----+-------+--------+--------------+

Таблица Department (Отдел):

+----+-------+
| id | name  |
+----+-------+
| 1  | IT    |
| 2  | Sales |
+----+-------+

Выходные данные:

+------------+----------+--------+
| Department | Employee | Salary |
+------------+----------+--------+
| IT         | Max      | 90000  |
| IT         | Joe      | 85000  |
| IT         | Randy    | 85000  |
| IT         | Will     | 70000  |
| Sales      | Henry    | 80000  |
| Sales      | Sam      | 60000  |
+------------+----------+--------+

Пояснение:
В отделе IT:
- Max получает самую высокую уникальную зарплату
- Randy и Joe получают вторую по величине уникальную зарплату
- Will получает третью по величине уникальную зарплату

В отделе Sales:
- Henry получает самую высокую зарплату
- Sam получает вторую по величине зарплату
- Нет третьей по величине зарплаты, так как в отделе всего два сотрудника
