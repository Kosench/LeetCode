### 176. Вторая по величине зарплата
Решено  
Средняя сложность

#### Задача:
Дана таблица `Employee`. Необходимо написать запрос, который найдет вторую по величине **уникальную** зарплату из таблицы `Employee`. Если второй по величине зарплаты нет, вернуть `null` (или `None` в Pandas).

---

#### Структура таблицы:

**Таблица Employee:**

| Column Name | Type |
|-------------|------|
| id          | int  |
| salary      | int  |

- `id` — первичный ключ (уникальное значение) для этой таблицы.
- Каждая строка таблицы содержит информацию о зарплате сотрудника.

---

#### Примеры:

**Пример 1:**

**Ввод:**

Таблица `Employee`:

| id | salary |
|----|--------|
| 1  | 100    |
| 2  | 200    |
| 3  | 300    |

**Вывод:**

| SecondHighestSalary |
|---------------------|
| 200                 |

**Объяснение:**  
Вторая по величине уникальная зарплата — это `200`.

---

**Пример 2:**

**Ввод:**

Таблица `Employee`:

| id | salary |
|----|--------|
| 1  | 100    |

**Вывод:**

| SecondHighestSalary |
|---------------------|
| null                |

**Объяснение:**  
В таблице только одна уникальная зарплата, поэтому второй по величине зарплаты нет, и результат — `null`.

---

#### Решение (SQL):

Для решения задачи можно использовать подзапрос с функцией `DISTINCT`, чтобы найти уникальные зарплаты, и затем выбрать вторую по величине зарплату. Если такой зарплаты нет, то используется `NULL`.

```sql
SELECT 
    (SELECT DISTINCT salary
     FROM Employee
     ORDER BY salary DESC
     LIMIT 1 OFFSET 1) AS SecondHighestSalary;
```

---

#### Пояснение к запросу:
1. **Подзапрос**:
    - `SELECT DISTINCT salary`: Выбираем уникальные значения зарплат.
    - `ORDER BY salary DESC`: Сортируем зарплаты по убыванию.
    - `LIMIT 1 OFFSET 1`: Пропускаем первую зарплату (самую высокую) и выбираем следующую за ней.
2. **Основной запрос**:
    - Если подзапрос не возвращает значений (например, если в таблице меньше двух уникальных зарплат), результат будет `NULL`.

---

#### Результат:
Запрос вернет таблицу с одной колонкой `SecondHighestSalary`, содержащей вторую по величине уникальную зарплату. Если такой зарплаты нет, результат будет `null`.